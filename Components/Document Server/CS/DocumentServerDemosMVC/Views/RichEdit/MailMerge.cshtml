@model RichEditMailMergeModel
<script type="text/javascript">
    // <![CDATA[
    function UpdatePreview() {
        var EmployeeIdValue = EmployeeId.GetValue();
        var CustomerIdValue = CustomerId.GetValue();
        var previewFrame = document.getElementById("previewFrame");
        var args = "EmployeeID=" + encodeURIComponent(EmployeeIdValue) +
                    "&CustomerID=" + encodeURIComponent(CustomerIdValue);
        RichEditPreview.Update(args);        
    }
    // ]]> 
</script>

@using (Html.BeginForm("MailMergeExportTo", "RichEdit", FormMethod.Post)) {

    @Html.DevExpress().ComboBoxFor(model => model.EmployeeId,
    settings => {
        settings.Properties.ValueField = "EmployeeID";
        settings.Properties.ValueType = typeof(int);
        settings.Properties.Columns.Add("FirstName");
        settings.Properties.Columns.Add("LastName");
        settings.Properties.TextFormatString = "{0} {1}";
        settings.Properties.ClientSideEvents.ValueChanged = "function(s, e) { UpdatePreview(); }";
    }).BindList(Model.Employees).GetHtml()

    @Html.DevExpress().ComboBoxFor(model => model.CustomerId,
    settings => {
        settings.Properties.ValueField = "CustomerID";
        settings.Properties.TextField = "ContactName";
        settings.Properties.ClientSideEvents.ValueChanged = "function(s, e) { UpdatePreview(); }";
    }).BindList(Model.Customers).GetHtml()

    @Html.Partial("RichEditDocumentDownloaderPartial")
    @Html.Partial("RichEditPreviewPartial", Model.PreviewModel)
}