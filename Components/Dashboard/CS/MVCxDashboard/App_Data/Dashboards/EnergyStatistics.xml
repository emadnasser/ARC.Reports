<?xml version="1.0" encoding="utf-8"?>
<Dashboard CurrencyCulture="en-US">
  <Title Text="Energy Statistics" />
  <DataSources>
    <ObjectDataSource ComponentName="dsCountries">
      <Name>Countries</Name>
      <DataMember>Countries</DataMember>
      <CalculatedFields>
        <CalculatedField Name="YearImport" Expression="ToDecimal(Iif(GetYear([Year]) = [Parameters.Year], [Import], 0))" DataType="Object" />
        <CalculatedField Name="YearProduction" Expression="ToDecimal(Iif(GetYear([Year]) = [Parameters.Year], [Production], 0))" DataType="Object" />
        <CalculatedField Name="YearTotal" Expression="ToDecimal([YearProduction] + [YearImport])" DataType="Object" />
        <CalculatedField Name="DomesticShare" Expression="ToDecimal(Iif(Sum([YearTotal]) = 0, 0, Sum([YearProduction]) / Sum([YearTotal])))" DataType="Object" />
      </CalculatedFields>
    </ObjectDataSource>
  </DataSources>
  <Parameters>
    <Parameter Name="Year" Type="System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" Value="2009">
      <StaticListLookUpSettings>
        <Values>
          <Value>1999</Value>
          <Value>2000</Value>
          <Value>2001</Value>
          <Value>2002</Value>
          <Value>2003</Value>
          <Value>2004</Value>
          <Value>2005</Value>
          <Value>2006</Value>
          <Value>2007</Value>
          <Value>2008</Value>
          <Value>2009</Value>
        </Values>
      </StaticListLookUpSettings>
    </Parameter>
  </Parameters>
  <Items>
    <Grid ComponentName="gridProductionImportByCountry" Name="Energy Statistics by Country" ShowCaption="false" DataSource="dsCountries">
      <DataItems>
        <Dimension DataMember="Country" UniqueName="DataItem0" />
        <Measure DataMember="YearProduction" UniqueName="DataItem1">
          <NumericFormat FormatType="Number" />
        </Measure>
        <Measure DataMember="YearProduction" UniqueName="DataItem4" />
        <Measure DataMember="YearImport" UniqueName="DataItem3">
          <NumericFormat FormatType="Number" />
        </Measure>
        <Measure DataMember="Production" UniqueName="DataItem5">
          <NumericFormat FormatType="Number" />
        </Measure>
        <Dimension DataMember="Year" UniqueName="DataItem2" />
        <Measure DataMember="DomesticShare" Name="Domestic Share" SummaryType="Count" UniqueName="DataItem6">
          <NumericFormat FormatType="Percent" />
        </Measure>
      </DataItems>
      <FormatRules>
        <GridItemFormatRule Name="FormatRule 1" DataItem="DataItem6">
          <FormatConditionValue Condition="GreaterOrEqual">
            <AppearanceSettings AppearanceType="FontGreen" />
            <Value1 Type="System.Decimal" Value="0.5" />
          </FormatConditionValue>
        </GridItemFormatRule>
        <GridItemFormatRule Name="FormatRule 2" DataItem="DataItem6">
          <FormatConditionValue Condition="Less">
            <AppearanceSettings AppearanceType="FontYellow" />
            <Value1 Type="System.Decimal" Value="0.5" />
          </FormatConditionValue>
        </GridItemFormatRule>
        <GridItemFormatRule Name="FormatRule 3" DataItem="DataItem6">
          <FormatConditionValue>
            <AppearanceSettings AppearanceType="FontRed" />
            <Value1 Type="System.Int32" Value="0" />
          </FormatConditionValue>
        </GridItemFormatRule>
      </FormatRules>
      <GridColumns>
        <GridDimensionColumn Name="Country" Weight="42.549180327868854">
          <Dimension UniqueName="DataItem0" />
        </GridDimensionColumn>
        <GridMeasureColumn Weight="63.450532067874612">
          <Measure UniqueName="DataItem6" />
        </GridMeasureColumn>
        <GridMeasureColumn Name="Production" Weight="48.52099511072764">
          <Measure UniqueName="DataItem1" />
        </GridMeasureColumn>
        <GridDeltaColumn Name="Import" Weight="41.056226632154164">
          <ActualValue UniqueName="DataItem3" />
          <TargetValue UniqueName="DataItem4" />
          <DeltaOptions ValueType="ActualValue" ResultIndicationMode="WarningIfGreater" />
        </GridDeltaColumn>
        <GridSparklineColumn Name="Trend" Weight="59.718147828587874">
          <SparklineValue UniqueName="DataItem5" />
          <SparklineOptions ViewType="Area" />
        </GridSparklineColumn>
      </GridColumns>
      <SparklineArgument UniqueName="DataItem2" />
      <GridOptions ShowHorizontalLines="false" ColumnWidthMode="Manual" />
    </Grid>
    <PieMap ComponentName="mapProduction" Name="Energy Statistics by Country" DataSource="dsCountries" ShapefileArea="Europe" ShapeTitleAttributeName="NAME">
      <InteractivityOptions IgnoreMasterFilters="true" MasterFilterMode="Multiple" />
      <DataItems>
        <Dimension DataMember="Country" UniqueName="DataItem5" />
        <Measure DataMember="YearImport" Name="Import" UniqueName="DataItem2">
          <NumericFormat FormatType="Number" />
        </Measure>
        <Dimension DataMember="EnergyType" UniqueName="DataItem3" />
        <Measure DataMember="YearProduction" Name="Production" UniqueName="DataItem4">
          <NumericFormat FormatType="Number" />
        </Measure>
        <Dimension DataMember="Longitude" UniqueName="DataItem1" />
        <Dimension DataMember="Latitude" UniqueName="DataItem0" />
      </DataItems>
      <ViewArea TopLatitude="71.177685546874955" BottomLatitude="27.646386718750023" LeftLongitude="-31.282958984375" RightLongitude="66.365625000000051" CenterPointLatitude="54.855558031681227" CenterPointLongitude="17.541333007812533" />
      <MapLegend Visible="true" />
      <WeightedLegend Visible="true" Position="BottomLeft" />
      <Latitude UniqueName="DataItem0" />
      <Longitude UniqueName="DataItem1" />
      <TooltipDimensions>
        <TooltipDimension UniqueName="DataItem5" />
      </TooltipDimensions>
      <Argument UniqueName="DataItem3" />
      <Values>
        <Value UniqueName="DataItem4" />
        <Value UniqueName="DataItem2" />
      </Values>
    </PieMap>
    <Card ComponentName="cardProductionImportByType" Name="Energy Statistics by Type - Production vs Import" DataSource="dsCountries" FilterString="[DataItem0] In ('Petroleum Products', 'Solid Fuels', 'Gases')" ContentLineCount="1">
      <InteractivityOptions MasterFilterMode="Single" />
      <DataItems>
        <Dimension DataMember="EnergyType" UniqueName="DataItem0" />
        <Measure DataMember="YearProduction" UniqueName="DataItem1">
          <NumericFormat FormatType="Number" />
        </Measure>
        <Measure DataMember="YearImport" UniqueName="DataItem2" />
      </DataItems>
      <SeriesDimensions>
        <SeriesDimension UniqueName="DataItem0" />
      </SeriesDimensions>
      <Card>
        <ActualValue UniqueName="DataItem1" />
        <TargetValue UniqueName="DataItem2" />
        <DeltaOptions ValueType="ActualValue" ResultIndicationMode="WarningIfLess" />
      </Card>
    </Card>
  </Items>
  <LayoutTree>
    <LayoutGroup>
      <LayoutItem DashboardItem="mapProduction" Weight="62.99911268855368" />
      <LayoutGroup Orientation="Vertical" Weight="37.00088731144632">
        <LayoutItem DashboardItem="cardProductionImportByType" Weight="40.970873786407765" />
        <LayoutItem DashboardItem="gridProductionImportByCountry" Weight="59.029126213592235" />
      </LayoutGroup>
    </LayoutGroup>
  </LayoutTree>
</Dashboard>