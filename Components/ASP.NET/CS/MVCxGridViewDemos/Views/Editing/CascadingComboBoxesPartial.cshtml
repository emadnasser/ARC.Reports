@{
    Html.EnableClientValidation();
    Html.EnableUnobtrusiveJavaScript();

    Html.DevExpress().GridView<EditableCustomer>(settings => {
        settings.Name = "GridView";
        settings.KeyFieldName = "CustomerID";
        settings.CallbackRouteValues = new { Controller = "Editing", Action = "CascadingComboBoxesPartial" };
        settings.SettingsEditing.UpdateRowRouteValues = new { Controller = "Editing", Action = "CascadingComboBoxesUpdatePartial" };
        settings.SettingsEditing.Mode = GridViewEditingMode.Inline;
        settings.Width = Unit.Percentage(100);

        settings.CommandColumn.Visible = true;
        settings.CommandColumn.ShowEditButton = true;

        settings.Columns.Add(m => m.Country, column => {
            column.EditorProperties().ComboBox(p => {
                p.TextField = "CountryName";
                p.ValueField = "CountryName";
                p.DataSource = WorldCitiesDataProvider.GetCountries();
                p.ClientSideEvents.SelectedIndexChanged = "OnSelectedCountryChanged";
            });
        });

        settings.Columns.Add(m => m.City, column => {
            column.EditorProperties().ComboBox(p => {
                p.CallbackRouteValues = new { Controller = "Editing", Action = "GetCities", TextField = "CityName" };
                p.TextField = "CityName";
                p.LoadDropDownOnDemand = true;
                p.ClientSideEvents.BeginCallback = "CityComboBox_BeginCallback";
            });
        });
        settings.Columns.Add(m => m.ContactName);
        settings.Columns.Add(m => m.CompanyName);

        settings.CellEditorInitialize = (sender, e) => {
            ASPxEdit editor = (ASPxEdit)e.Editor;
            editor.ValidationSettings.Display = Display.Dynamic;
        };
        settings.PreRender = (sender, e) => {
            ((MVCxGridView)sender).StartEdit(3);
        };
    }).SetEditErrorText(ViewBag.EditError).Bind(Model).GetHtml();
}