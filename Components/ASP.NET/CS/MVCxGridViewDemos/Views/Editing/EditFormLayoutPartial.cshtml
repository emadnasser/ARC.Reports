@{
    var grid = Html.DevExpress().GridView(
        settings => {
            settings.Name = "gvEditing";
            settings.KeyFieldName = "ProductID";
            settings.CallbackRouteValues = new { Controller = "Editing", Action = "EditFormLayoutPartial" };
            settings.SettingsEditing.AddNewRowRouteValues = new { Controller = "Editing", Action = "EditFormLayoutAddNewPartial" };
            settings.SettingsEditing.UpdateRowRouteValues = new { Controller = "Editing", Action = "EditFormLayoutUpdatePartial" };
            settings.SettingsEditing.DeleteRowRouteValues = new { Controller = "Editing", Action = "EditFormLayoutDeletePartial" };
            settings.SettingsEditing.Mode = GridViewEditingMode.EditFormAndDisplayRow;
            settings.SettingsBehavior.ConfirmDelete = true;
            settings.Width = Unit.Percentage(100);

            settings.CommandColumn.Visible = true;
            settings.CommandColumn.ShowNewButton = true;
            settings.CommandColumn.ShowDeleteButton = true;
            settings.CommandColumn.ShowEditButton = true;

            settings.Columns.Add("ProductName");
            settings.Columns.Add(column => {
                column.FieldName = "CategoryID";
                column.Caption = "Category";
                
                column.EditorProperties().ComboBox(p => {
                    p.TextField = "CategoryName";
                    p.ValueField = "CategoryID";
                    p.ValueType = typeof(int);
                    p.DataSource = NorthwindDataProvider.GetCategories();
                });
            });
            settings.Columns.Add("QuantityPerUnit");
            settings.Columns.Add(column => {
                column.FieldName = "UnitPrice";
                column.EditorProperties().SpinEdit(p => {
                    p.DisplayFormatString = "c";
                    p.DisplayFormatInEditMode = true;
                });
            });
            settings.Columns.Add("UnitsInStock", MVCxGridViewColumnType.SpinEdit);
            settings.Columns.Add("Discontinued", MVCxGridViewColumnType.CheckBox);

            settings.EditFormLayoutProperties.ColCount = 2;
            settings.EditFormLayoutProperties.Items.Add("ProductName");
            settings.EditFormLayoutProperties.Items.Add("Category");
            settings.EditFormLayoutProperties.Items.Add("QuantityPerUnit");
            settings.EditFormLayoutProperties.Items.Add("UnitPrice");
            settings.EditFormLayoutProperties.Items.Add("UnitsInStock");
            settings.EditFormLayoutProperties.Items.Add("Discontinued");
            settings.EditFormLayoutProperties.Items.AddCommandItem(itemSettings => {
                itemSettings.ColSpan = 2;
                itemSettings.HorizontalAlign = FormLayoutHorizontalAlign.Right;
            });
            settings.PreRender = (sender, e) => {
                ((MVCxGridView)sender).StartEdit(1);
            };            
        });
    if(ViewData["EditError"] != null) {
        grid.SetEditErrorText((string)ViewData["EditError"]);
    }
}
@grid.Bind(Model).GetHtml()