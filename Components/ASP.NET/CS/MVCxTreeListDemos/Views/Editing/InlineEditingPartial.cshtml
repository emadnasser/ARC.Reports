@model IEnumerable<EditablePost>
           
@{
    Html.EnableClientValidation();
    Html.EnableUnobtrusiveJavaScript();
    
    var treeList = Html.DevExpress().TreeList(
        settings => {
            settings.Name = "treeList";
            settings.CallbackRouteValues = new { Controller = "Editing", Action = "InlineEditingPartial" };

            settings.AutoGenerateColumns = false;
            settings.Width = Unit.Percentage(100);

            settings.KeyFieldName = "PostID";
            settings.ParentFieldName = "ParentID";

            settings.Columns.Add("From");
            settings.Columns.Add("Subject");
            settings.Columns.Add(
                column => {
                    column.FieldName = "PostDate";
                    column.Caption = "Date";
                    column.EditorProperties().DateEdit(p => {
                        p.DisplayFormatString = "dd/MM/yyyy hh:mm tt";
                        p.DisplayFormatInEditMode = true;
                        p.EditFormat = EditFormat.DateTime;
                    });
                }
            );
            settings.Columns.Add("IsNew", "Is New", MVCxTreeListColumnType.CheckBox);
            settings.Columns.Add("HasAttachment", "Has Attachment", MVCxTreeListColumnType.CheckBox);

            settings.CommandColumn.Visible = true;
            settings.CommandColumn.ShowNewButtonInHeader = true;
            settings.CommandColumn.NewButton.Visible = true;
            settings.CommandColumn.DeleteButton.Visible = true;
            settings.CommandColumn.EditButton.Visible = true;

            settings.SettingsEditing.AddNewNodeRouteValues = new { Controller = "Editing", Action = "InlineEditingAddNewPostPartial" };
            settings.SettingsEditing.UpdateNodeRouteValues = new { Controller = "Editing", Action = "InlineEditingUpdatePostPartial" };
            settings.SettingsEditing.NodeDragDropRouteValues = new { Controller = "Editing", Action = "InlineEditingMovePostPartial" };
            settings.SettingsEditing.DeleteNodeRouteValues = new { Controller = "Editing", Action = "InlineEditingDeletePostPartial" };
            settings.SettingsEditing.ConfirmDelete = true;

            settings.Settings.GridLines = System.Web.UI.WebControls.GridLines.Both;
            settings.SettingsBehavior.ExpandCollapseAction = TreeListExpandCollapseAction.NodeDblClick;

            settings.PreRender = (sender, e) => {
                MVCxTreeList treeListControl = (MVCxTreeList)sender;
                treeListControl.ExpandToLevel(3);
                treeListControl.StartEdit("2");
            };
        }
    );

    if(ViewData["EditNodeError"] != null) {
        treeList.SetEditErrorText((string)ViewData["EditNodeError"]);
    }
}

@treeList.Bind(Model).GetHtml()