@model SchedulerDataObject

<script type="text/javascript">
    $(document).ready(function(){
        $("#showPreview").click(function(){
            reportContainer.Show();
            reportViewer.Refresh();
        });
        $("#reportTemplateFileName").change(function(){
            UpdateDemoOptions();
        });
    });
    function OnDateChanged(s, e){
        ValidateTimeInterval();
        UpdateDemoOptions();
    }
    function UpdateDemoOptions(){
        $.ajax({
            url: '@Url.Action("ReportTemplatesUpdateOptions", "Reporting")',
            data: {
                ReportTemplateFileName: $("#reportTemplateFileName").val(),
                StartDate: startDate.GetValueString(),
                EndDate: endDate.GetValueString()
            }
        });
    }
    function ValidateTimeInterval(){
        var startValue = startDate.GetDate();
        var endValue = endDate.GetDate();
        if(endValue < startValue)
            endDate.SetDate(startValue);
    }
</script>
<div class="chartOptionsPanel horizOptionsPanel" style="height:55px;margin-bottom:15px;">
    <table class="OptionsTable">
        <tr>
            <td>Select a template file to load...</td>
            <td>Print From:</td>
            <td>Print To:</td>
            <td></td>
        </tr>
        <tr>
            <td>
                @Html.DropDownList(
                    "reportTemplateFileName", 
                    new SelectList(SchedulerDemoHelper.ReportTemplateFileNames, SchedulerDemoHelper.ReportTemplatesOptions.ReportTemplateFileName)
                )
            </td>
            <td>
                @Html.DevExpress().DateEdit(
                    settings =>{
                        settings.Name = "startDate";
                        settings.Width = Unit.Pixel(113);
                        settings.Properties.ClientSideEvents.DateChanged = "OnDateChanged";
                    }).Bind(SchedulerDemoHelper.ReportTemplatesOptions.StartDate).GetHtml()
            </td>
            <td>
                @Html.DevExpress().DateEdit(
                    settings => {
                        settings.Name = "endDate";
                        settings.Width = Unit.Pixel(126);
                        settings.Properties.ClientSideEvents.DateChanged = "OnDateChanged";
                    }).Bind(SchedulerDemoHelper.ReportTemplatesOptions.EndDate).GetHtml()
            </td>
            <td>
                <input type="button" id="showPreview" value="Show Preview" style="margin-bottom:7px;"/>
            </td>
        </tr>
    </table>
</div>
@Html.Partial("ReportTemplatesPartial", Model)
@Html.Partial("ReportTemplatesPreviewPartial")